<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Triangulator</title>
    <!-- <link href="css/Triangulator.css" rel="stylesheet">-->
</head>
<body>
    <h1>Triangulator</h1>

    <div>
        <input type="text" id="input"><br>
        <input type="button" value="search" onclick="getTriangle();" />
    </div>
    <canvas id="triangleCanvas" width="180" height="180" style="border: solid black;"></canvas>
    <p id="triangleName" />
    <p id="triangleCoordinates" />
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>

    <script>
        var uri;
        function getTriangle() {
            var input = document.getElementById('input').value;
            if (input.length < 4) {
                uri = 'api/triangulator/GetCoordinates/';
            }
            else{
                uri = 'api/triangulator/GetTriangleName/';
            }
            $.getJSON(uri + input)
                .done(function (triangle) {
                    $('#triangleName').text('Triangle Name: ' + triangle.triangleName);
                    $('#triangleCoordinates').text('Coordinates: ' + triangle.coordinates);
                    clearGrid();
                    drawTriangle(triangle.coordinates);
                })
                .fail(function (jqXHR, textStatus, err) {
                    $('#triangleName').text('Error: Invalid Entry - ' + err);
                    $('#triangleCoordinates').text('');
                    clearGrid();
                });
        }

        function drawTriangle(coordinates) {
            var triangleCanvas = document.getElementById('triangleCanvas');
            if (triangleCanvas.getContext) {
                coordinates = coordinates.replace(/[()]/g, '');
                coordinates = coordinates.split(',');
                var context = triangleCanvas.getContext('2d');
                context.beginPath();
                context.moveTo(coordinates[0] * 3, coordinates[1] * 3); // Multply all coordinates by 3 to fit canvas (180,180)
                context.lineTo(coordinates[2] * 3, coordinates[3] * 3); // Multply all coordinates by 3 to fit canvas (180,180)
                context.lineTo(coordinates[4] * 3, coordinates[5] * 3); // Multply all coordinates by 3 to fit canvas (180,180)
                context.fill();
            }
        }

        function clearGrid() {
            var triangleCanvas = document.getElementById('triangleCanvas');
            if (triangleCanvas.getContext) {
                var context = triangleCanvas.getContext('2d');
                context.clearRect(0, 0, triangleCanvas.width, triangleCanvas.height);
            }
        }
    </script>
</body>
</html>